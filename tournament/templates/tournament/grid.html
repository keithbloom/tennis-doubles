{% extends "base.html" %}
{% load custom_tags %}

{% block content %}
<div class="bg-slate-50 container mx-auto">
    {% include "components/header.html" with tournament=tournament %}

    <!-- Prev/Next Navigation -->
    <div class="w-full max-w-3xl md:max-w-5xl lg:max-w-6xl mx-auto px-4 pt-4">
        <div class="flex justify-between items-center mb-4">
            <div>
                {% if prev_tournament %}
                <a href="{% url 'tournament_detail' prev_tournament.id %}"
                   class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    <svg class="mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    Previous
                </a>
                {% else %}
                <div class="inline-flex items-center px-4 py-2 border border-gray-200 text-sm font-medium rounded-md text-gray-400 bg-gray-100 cursor-not-allowed">
                    <svg class="mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    Previous
                </div>
                {% endif %}
            </div>

            <a href="{% url 'tournament_history' %}"
               class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                View All Tournaments
            </a>

            <div>
                {% if next_tournament %}
                <a href="{% url 'tournament_detail' next_tournament.id %}"
                   class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Next
                    <svg class="ml-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                    </svg>
                </a>
                {% else %}
                <div class="inline-flex items-center px-4 py-2 border border-gray-200 text-sm font-medium rounded-md text-gray-400 bg-gray-100 cursor-not-allowed">
                    Next
                    <svg class="ml-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                    </svg>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="w-full max-w-3xl md:max-w-5xl lg:max-w-6xl mx-auto p-4"
        x-data="{ activeTab: '{{ group_data.0.group.name }}' }">

        <!-- Tab Headers -->
        <div class="bg-gray-200 rounded-t-lg shadow-md overflow-hidden">
            <div class="flex">
                {% for data in group_data %}
                {% with group_index=forloop.counter0 %}
                <button class="flex-1 py-3 px-4 text-center text-base transition duration-200 ease-in-out relative"
                    :class="{
                        'bg-tab-badge-{{ group_index }} text-black font-bold': activeTab === '{{ data.group.name }}',
                        'bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium': activeTab !== '{{ data.group.name }}'
                    }"
                    @click="activeTab = '{{ data.group.name }}'">
                    {{ data.group.name }}
                    <div class="absolute bottom-0 left-0 right-0 h-1 transition-all duration-200 ease-in-out"
                        :class="{'opacity-100 bg-tab-badge-{{ group_index }}': activeTab === '{{ data.group.name }}', 'opacity-0 bg-gray-200': activeTab !== '{{ data.group.name }}'}">
                    </div>
                </button>
                {% endwith%}
                {% endfor %}
            </div>
        </div>

        <!-- Tab Content -->
        <div class="bg-white rounded-b-lg shadow-md p-4" x-show="activeTab"
            x-transition:enter="transition ease-out duration-300"
            x-transition:enter-start="opacity-0 transform scale-95"
            x-transition:enter-end="opacity-100 transform scale-100">
            {% for data in group_data %}
            {% with group_count=forloop.counter0 %}
            {% include "components/group_tab.html" with data=data group=data.group group_index=group_count %}
            {% endwith %}
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}